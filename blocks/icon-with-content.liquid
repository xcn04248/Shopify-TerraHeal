{% liquid
  assign nowrap = false
  if block.settings.image != blank or block.settings.icon != blank
    assign has_icon = true
  else
    assign has_icon = false
  endif
%}
<style>
  {% if block.settings.icon_color == 'custom' %}
    .icons-with-text__icon-item-{{ block.id }} .material-icon {
      color: {{ block.settings.custom_icon_color }}
    }
  {% endif %}
  {% if block.settings.text_color == 'custom' %}
    .icons-with-text__icon-item-{{ block.id }} {
      --color-foreground: {{ block.settings.custom_text_color.red }}, {{ block.settings.custom_text_color.green }}, {{ block.settings.custom_text_color.blue }};
      color: rgb(var(--color-foreground));
    }
  {% endif %}
  .icons-with-text__icon-item-{{ block.id }} .rte p {
    font-size: {{ block.settings.text_size | divided_by: 10.0 }}rem;
  }
  {% if block.settings.block_width == 'fixed' %}
    .icons-with-text__icon-item-{{ block.id }} {
      width: {{ block.settings.block_mobile_width }}px;
      flex-shrink: 0;
    }
    @media screen and (min-width: 750px) {
      .icons-with-text__icon-item-{{ block.id }} {
        width: {{ block.settings.block_desktop_width }}px;
      }
    }
  {% elsif block.settings.block_width == 'unlimited' %}
    {% assign nowrap = true %}
  {% endif %}
</style>
<div
  class="icons-with-text__icon-item icons-with-text__icon-item-{{ block.id }} icons-with-text__icon-item--{{ block.settings.icon_position }} icons-with-text__icon-item--{{ block.settings.icon_text_alignment }} text-color-{{ block.settings.text_color }} {{ block.settings.visibility }}"
  style="
    margin-top: {{ block.settings.margin_top | divided_by: 10.0 }}rem;
    margin-bottom: {{ block.settings.margin_bottom | divided_by: 10.0 }}rem;
  "
>
  {% if block.settings.icon_position != 'next-to-title' and has_icon %}
    <div class="icons-with-text__icon__icon icons-with-text__icon__icon--{{ block.settings.icon_size }} color-{{ block.settings.icon_color }}">
      {%- if block.settings.image != blank -%}
        <img
          src="{{ block.settings.image | image_url: width: 300 }}"
          {% if block.settings.image.alt != blank %}
            alt="{{ block.settings.image.alt | escape }}"
          {% else %}
            role="presentation"
          {% endif %}
          height="auto"
          width="auto"
          loading="lazy"
        >
      {%- else -%}
        {% render 'material-icon', icon: block.settings.icon, filled: block.settings.filled_icon %}
      {%- endif -%}
    </div>
  {% endif %}
  <div class="icons-with-text__icon__text{% if nowrap %} nowrap{% endif %}">
    <h3 class="icons-with-text__icon__title {{ block.settings.icon_heading_size }}">
      {% if block.settings.icon_position == 'next-to-title' and has_icon %}
        <div class="icons-with-text__icon__icon icons-with-text__icon__icon--title icons-with-text__icon__icon--{{ block.settings.icon_size }} color-{{ block.settings.icon_color }}">
          {%- if block.settings.image != blank -%}
            <img
              src="{{ block.settings.image | image_url: width: 300 }}"
              {% if block.settings.image.alt != blank %}
                alt="{{ block.settings.image.alt | escape }}"
              {% else %}
                role="presentation"
              {% endif %}
              height="auto"
              width="auto"
              loading="lazy"
            >
          {%- else -%}
            {% render 'material-icon', icon: block.settings.icon, filled: block.settings.filled_icon %}
          {%- endif -%}
        </div>
      {% endif %}
      <span>
        {{ block.settings.title | escape }}
      </span>
    </h3>
    {%- if block.settings.text != blank -%}
      <div class="rte">
        {{ block.settings.text }}
      </div>
    {%- endif -%}
  </div>
</div>

{% schema %}
{
  "name": "Icon with content",
  "tag": null,
  "settings": [
    {
      "type": "select",
      "id": "visibility",
      "options": [
        {
          "value": "desktop-hidden",
          "label": "Mobile only"
        },
        {
          "value": "mobile-hidden",
          "label": "Desktop only"
        },
        {
          "value": "always-display",
          "label": "All devices"
        }
      ],
      "label": "Display on",
      "default": "always-display"
    },
    {
      "type": "header",
      "content": "Icon"
    },
    {
      "type": "text",
      "id": "icon",
      "default": "check_circle",
      "label": "Icon",
      "info": "[View all available icons](https:\/\/fonts.google.com\/icons?icon.set=Material+Symbols&icon.platform=web)."
    },
    {
      "type": "checkbox",
      "id": "filled_icon",
      "default": false,
      "label": "Filled icon"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Custom icon"
    },
    {
      "type": "select",
      "id": "icon_size",
      "label": "Icon size",
      "options": [
        {
          "value": "xs",
          "label": "Extra small"
        },
        {
          "value": "s",
          "label": "Small"
        },
        {
          "value": "m",
          "label": "Medium"
        },
        {
          "value": "l",
          "label": "Large"
        },
        {
          "value": "xl",
          "label": "Extra large"
        },
        {
          "value": "xxl",
          "label": "Double extra large"
        }
      ],
      "default": "m"
    },
    {
      "type": "select",
      "id": "icon_position",
      "options": [
        {
          "value": "above",
          "label": "Above title & text"
        },
        {
          "value": "next-to-title",
          "label": "Next to title"
        },
        {
          "value": "next-to-text",
          "label": "Next to text & title"
        }
      ],
      "label": "Icon position",
      "default": "next-to-title"
    },
    {
      "type": "select",
      "id": "icon_color",
      "options": [
        {
          "value": "accent-1",
          "label": "Accent 1"
        },
        {
          "value": "accent-2",
          "label": "Accent 2"
        },
        {
          "value": "background-1",
          "label": "Background 1"
        },
        {
          "value": "background-2",
          "label": "Background 2"
        },
        {
          "value": "inverse",
          "label": "Text"
        },
        {
          "value": "custom",
          "label": "Custom"
        }
      ],
      "default": "accent-1",
      "label": "Icon color",
      "visible_if": "{{ block.settings.image == blank }}"
    },
    {
      "type": "color",
      "id": "custom_icon_color",
      "label": "Custom icon color",
      "default": "#FF0000",
      "visible_if": "{{ block.settings.icon_color == 'custom' and block.settings.image == blank }}"
    },
    {
      "type": "header",
      "content": "Text"
    },
    {
      "type": "select",
      "id": "icon_text_alignment",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "left",
      "label": "Text alignment",
      "visible_if": "{{ block.settings.icon_position != 'above' }}"
    },
    {
      "type": "select",
      "id": "text_color",
      "options": [
        {
          "value": "accent-1",
          "label": "Accent 1"
        },
        {
          "value": "accent-2",
          "label": "Accent 2"
        },
        {
          "value": "background-1",
          "label": "Background 1"
        },
        {
          "value": "background-2",
          "label": "Background 2"
        },
        {
          "value": "text",
          "label": "Text"
        },
        {
          "value": "custom",
          "label": "Custom"
        }
      ],
      "default": "text",
      "label": "Text color"
    },
    {
      "type": "color",
      "id": "custom_text_color",
      "label": "Custom text color",
      "default": "#FF0000",
      "visible_if": "{{ block.settings.text_color == 'custom' }}"
    },
    {
      "type": "text",
      "id": "title",
      "default": "Icon with text",
      "label": "Heading"
    },
    {
      "type": "select",
      "id": "icon_heading_size",
      "options": [
        {
          "value": "h5",
          "label": "Extra small"
        },
        {
          "value": "h4",
          "label": "Small"
        },
        {
          "value": "h3",
          "label": "Medium"
        },
        {
          "value": "h2",
          "label": "Large"
        }
      ],
      "default": "h3",
      "label": "Heading size",
      "visible_if": "{{ block.settings.title != blank }}"
    },
    {
      "type": "richtext",
      "id": "text",
      "default": "<p>Pair text with an icon to focus on your chosen product, collection, or blog post</p>",
      "label": "Text"
    },
    {
      "type": "range",
      "id": "text_size",
      "min": 10,
      "max": 24,
      "step": 1,
      "unit": "px",
      "default": 14,
      "label": "Text size"
    },
    {
      "type": "header",
      "content": "Margins"
    },
    {
      "type": "range",
      "id": "margin_top",
      "label": "Top",
      "min": 0,
      "max": 45,
      "step": 3,
      "unit": "px",
      "default": 15
    },
    {
      "type": "range",
      "id": "margin_bottom",
      "label": "Bottom",
      "min": 0,
      "max": 45,
      "step": 3,
      "unit": "px",
      "default": 15
    }
  ],
  "presets": [{ "name": "Icon with content", "category": "Icons" }]
}
{% endschema %}
